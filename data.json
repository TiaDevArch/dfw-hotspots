import requests
import json

NOTION_TOKEN = "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"
DATABASE_ID = "20730f74873f80d991e6fafc7d14d420"

headers = {
    "Authorization": f"Bearer {NOTION_TOKEN}",
    "Notion-Version": "2022-06-28",
    "Content-Type": "application/json"
}

url = f"https://api.notion.com/v1/databases/{DATABASE_ID}/query"

response = requests.post(url, headers=headers)
data = response.json()

output = []

for result in data["results"]:
    props = result["properties"]
    output.append({
        "name": props["Destination/Event Name"]["title"][0]["text"]["content"],
        "description": props["Description"]["rich_text"][0]["text"]["content"] if props["Description"]["rich_text"] else "",
        "category": props["Category"]["select"]["name"],
        "location": props["Location"]["rich_text"][0]["text"]["content"] if props["Location"]["rich_text"] else "",
        "cost": props["Cost"]["rich_text"][0]["text"]["content"] if props["Cost"]["rich_text"] else "",
        "tags": [t["name"] for t in props["Tags/Vibes"]["multi_select"]],
        "maps": props["Google Maps Link"]["url"],
        "link": props["Event Page/Info Link"]["url"]
    })

with open("data.json", "w") as f:
    json.dump(output, f, indent=2)

print("âœ… data.json has been created.")
